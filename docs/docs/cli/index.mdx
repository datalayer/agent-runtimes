---
title: CLI
---

# CLI

The `agent-runtimes` package provides a command-line interface for starting and managing the Agent Runtimes server.

## Installation

The CLI is automatically available when you install the package:

```bash
pip install agent-runtimes
```

## Commands Overview

The CLI provides three main commands:

| Command | Description |
|---------|-------------|
| `serve` | Start the agent-runtimes server |
| `list-agents` | Query running agents from a server |
| `list-specs` | List available agent specs from the library |

```bash
# Show available commands
agent-runtimes --help

# Or using the Python module directly
python -m agent_runtimes --help
```

## Programmatic Usage

The CLI commands can also be used as a library by other Python packages:

```python
from agent_runtimes.commands import (
    # Serve command
    serve_server,
    ServeError,
    LogLevel,
    
    # List agents command
    list_agents_from_server,
    ListAgentsError,
    
    # List specs command
    list_agent_specs,
    get_agent_specs,
    
    # Common
    OutputFormat,
)

# Start server programmatically
serve_server(host="0.0.0.0", port=8080)

# Query running agents
result = list_agents_from_server(host="localhost", port=8000)

# Get available agent specs
specs = get_agent_specs()
```

---

## `serve` Command

Start the agent-runtimes server.

```bash
agent-runtimes serve [OPTIONS]
```

### Options

| Option | Short | Default | Environment Variable | Description |
|--------|-------|---------|---------------------|-------------|
| `--host` | `-h` | `127.0.0.1` | `AGENT_RUNTIMES_HOST` | Host to bind to |
| `--port` | `-p` | `8000` | `AGENT_RUNTIMES_PORT` | Port to bind to |
| `--reload` | `-r` | `false` | `AGENT_RUNTIMES_RELOAD` | Enable auto-reload for development |
| `--debug` | `-d` | `false` | `AGENT_RUNTIMES_DEBUG` | Enable debug mode with verbose logging |
| `--workers` | `-w` | `1` | `AGENT_RUNTIMES_WORKERS` | Number of worker processes |
| `--log-level` | `-l` | `info` | `AGENT_RUNTIMES_LOG_LEVEL` | Log level (`debug`, `info`, `warning`, `error`, `critical`) |
| `--agent-id` | `-a` | - | `AGENT_RUNTIMES_DEFAULT_AGENT` | Agent spec ID from the library to start |
| `--agent-name` | `-n` | `default` | `AGENT_RUNTIMES_AGENT_NAME` | Custom name for the agent (requires `--agent-id`) |
| `--protocol` | `-t` | `ag-ui` | `AGENT_RUNTIMES_PROTOCOL` | Transport protocol (`ag-ui`, `vercel-ai`, `vercel-ai-jupyter`, `a2a`) |
| `--no-config-mcp-servers` | - | `false` | `AGENT_RUNTIMES_NO_CONFIG_MCP_SERVERS` | Skip starting config MCP servers from `~/.datalayer/mcp.json` |
| `--mcp-servers` | `-m` | - | `AGENT_RUNTIMES_MCP_SERVERS` | Comma-separated list of MCP server IDs from the catalog to start |
| `--codemode` | `-c` | `false` | `AGENT_RUNTIMES_CODEMODE` | Enable Code Mode: MCP servers become programmatic tools via CodemodeToolset |
| `--skills` | `-s` | - | `AGENT_RUNTIMES_SKILLS` | Comma-separated list of skills to enable (requires `--codemode`) |

### Basic Examples

```bash
# Start with defaults (localhost:8000)
agent-runtimes serve

# Start on all interfaces
agent-runtimes serve --host 0.0.0.0

# Start on a custom port
agent-runtimes serve --port 8080

# Combine both
agent-runtimes serve -h 0.0.0.0 -p 8080
```

### Development Mode

```bash
# Enable auto-reload for development
agent-runtimes serve --reload

# Enable debug logging
agent-runtimes serve --debug

# Both with short options
agent-runtimes serve -r -d
```

### Start with an Agent Spec

Agent specs are predefined agent configurations that include MCP servers and other settings:

```bash
# Start with a specific agent
agent-runtimes serve --agent-id data-acquisition

# Start with a custom agent name
agent-runtimes serve --agent-id crawler --agent-name my-crawler

# Using short options
agent-runtimes serve -a crawler -n my-crawler
```

### MCP Server Control

By default, the server automatically starts:
- **Config MCP servers** from `~/.datalayer/mcp.json`
- **Agent spec MCP servers** when using `--agent-id`

You can control which MCP servers are started:

```bash
# Start with specific MCP servers from the catalog
agent-runtimes serve --mcp-servers tavily,github

# Combine with an agent spec (agent spec servers + additional servers)
agent-runtimes serve --agent-id crawler --mcp-servers filesystem

# Start WITHOUT config MCP servers (from ~/.datalayer/mcp.json)
agent-runtimes serve --no-config-mcp-servers

# Start with agent but without config MCP servers
agent-runtimes serve --agent-id crawler --no-config-mcp-servers
```

:::tip Managing MCP Servers at Runtime
You can dynamically add MCP servers via the [REST API](/api-endpoints#enable-catalog-server):

```bash
# Enable an MCP server from the catalog
curl -X POST http://localhost:8000/api/v1/mcp/servers/catalog/tavily/enable

# Disable an MCP server
curl -X DELETE http://localhost:8000/api/v1/mcp/servers/catalog/tavily/disable
```

See the [MCP Servers API documentation](/api-endpoints#mcp-servers) for more details.
:::

### Code Mode

Code Mode transforms MCP servers into programmatic tools that can be composed through code execution. When enabled, the agent uses `CodemodeToolset` instead of directly adding MCP toolsets.

```bash
# Start with Code Mode enabled (uses config MCP servers)
agent-runtimes serve --codemode

# Start with Code Mode and specific MCP servers
agent-runtimes serve --codemode --mcp-servers tavily,github

# Start with Code Mode and an agent spec
agent-runtimes serve --agent-id crawler --codemode

# Start with Code Mode and skills
agent-runtimes serve --agent-id crawler --codemode --skills web_search,github_lookup

# Using short options
agent-runtimes serve -a crawler -c -s web_search,github_lookup
```

:::info How Code Mode Works
When `--codemode` is enabled:
1. MCP servers from the agent spec are converted to programmatic tools
2. The `CodemodeToolset` is used to expose tools via code execution
3. MCP toolsets are NOT added directly to the agent
4. Skills can be enabled for additional capabilities

This allows the agent to compose multiple tool calls within a single code execution, improving efficiency and enabling more complex workflows.
:::

#### Code Mode vs Standard Mode

| Feature | Standard Mode | Code Mode |
|---------|--------------|-----------|
| MCP tool invocation | Direct tool calls | Via code execution |
| Tool composition | One tool per LLM call | Multiple tools in single code block |
| Skill support | Not available | Full skill support |
| Tool discovery | Via MCP protocol | Via generated Python bindings |
| Execution context | Isolated per tool | Shared sandbox context |

### Skills

Skills are reusable agent capabilities that extend Code Mode functionality. They provide pre-built workflows that combine multiple tools.

```bash
# Start with a single skill
agent-runtimes serve --codemode --skills web_search

# Start with multiple skills (comma-separated)
agent-runtimes serve --codemode --skills web_search,github_lookup,file_operations

# Combine with an agent spec
agent-runtimes serve --agent-id crawler --codemode --skills web_search,data_analysis
```

:::note Skills Require Code Mode
The `--skills` option requires `--codemode` to be enabled. Skills are implemented as code-based workflows that run within the Code Mode sandbox.
:::

### Transport Protocols

Choose the transport protocol used for agent communication with `--protocol`:

```bash
# Default: AG-UI protocol (CopilotKit compatible)
agent-runtimes serve --agent-id crawler --protocol ag-ui

# Vercel AI SDK protocol
agent-runtimes serve --agent-id crawler --protocol vercel-ai

# Vercel AI Jupyter protocol (for notebook integration)
agent-runtimes serve --agent-id data-acquisition --protocol vercel-ai-jupyter

# A2A (Agent-to-Agent) protocol
agent-runtimes serve --agent-id crawler --protocol a2a
```

#### Available Protocols

| Protocol | Description |
|----------|-------------|
| `ag-ui` | CopilotKit-compatible AG-UI protocol (default) |
| `vercel-ai` | Vercel AI SDK protocol for streaming responses |
| `vercel-ai-jupyter` | Vercel AI with Jupyter notebook execution support |
| `a2a` | Agent-to-Agent protocol for multi-agent communication |

### Production Settings

```bash
# Multiple workers (not compatible with --reload)
agent-runtimes serve --workers 4

# Custom log level
agent-runtimes serve --log-level warning

# Production setup
agent-runtimes serve -h 0.0.0.0 -p 8000 -w 4 -l warning
```

---

## `list-agents` Command

Query running agents from an agent-runtimes server.

```bash
agent-runtimes list-agents [OPTIONS]
```

### Options

| Option | Short | Default | Environment Variable | Description |
|--------|-------|---------|---------------------|-------------|
| `--host` | `-h` | `127.0.0.1` | `AGENT_RUNTIMES_HOST` | Server host to query |
| `--port` | `-p` | `8000` | `AGENT_RUNTIMES_PORT` | Server port to query |
| `--output` | `-o` | `table` | - | Output format (`table` or `json`) |

### Examples

```bash
# List agents on default server (localhost:8000)
agent-runtimes list-agents

# List agents on a specific server
agent-runtimes list-agents --host 0.0.0.0 --port 8080

# Output as JSON
agent-runtimes list-agents --output json

# Using short options
agent-runtimes list-agents -h 0.0.0.0 -p 8080 -o json

# Using environment variables
AGENT_RUNTIMES_HOST=0.0.0.0 AGENT_RUNTIMES_PORT=8080 agent-runtimes list-agents
```

### Output Formats

**Table format (default):**

The table output uses rich formatting with color-coded status indicators:

```
ğŸš€ Running Agents on localhost:8000
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ID               â”‚ Name                   â”‚ Protocol â”‚  Status   â”‚ Description                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ crawler          â”‚ my-crawler             â”‚ ag-ui    â”‚ â— running â”‚ Web crawling and research ag... â”‚
â”‚ data-acquisition â”‚ default                â”‚ vercel-aiâ”‚ â— running â”‚ Acquires and manages data fr... â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Total: 2 agent(s)
```

- **Status indicators**: `â— running` (green) or `â—‹ stopped` (red)
- **ID column**: Green text for easy identification
- **Protocol column**: Magenta text showing the transport protocol
- **Description**: Truncated with ellipsis if too long

**JSON format:**
```json
{
  "agents": [
    {
      "id": "crawler",
      "name": "my-crawler",
      "status": "running",
      "description": "Web crawling and research agent",
      "capabilities": ["web_search", "content_extraction"]
    }
  ]
}
```

### Programmatic Usage

```python
from agent_runtimes.commands import list_agents_from_server, ListAgentsError

try:
    # Get agents as dictionary (no output printed)
    result = list_agents_from_server(host="localhost", port=8000)
    for agent in result["agents"]:
        print(f"Agent: {agent['id']} - {agent['status']}")
except ListAgentsError as e:
    print(f"Error: {e}")
```

---

## `list-specs` Command

List available agent specs from the library. Agent specs are predefined agent configurations that can be used with `--agent-id` when starting the server.

```bash
agent-runtimes list-specs [OPTIONS]
```

### Options

| Option | Short | Default | Description |
|--------|-------|---------|-------------|
| `--output` | `-o` | `table` | Output format (`table` or `json`) |

### Examples

```bash
# List available agent specs
agent-runtimes list-specs

# Output as JSON
agent-runtimes list-specs --output json

# Using short option
agent-runtimes list-specs -o json
```

### Output Formats

**Table format (default):**

The table output uses rich formatting with styled columns:

```
ğŸ¤– Available Agent Specs
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ ID                    â”‚ Name                           â”‚ Description                     â”‚ MCP Servers                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ data-acquisition      â”‚ Data Acquisition Agent         â”‚ Acquires and manages data fr... â”‚ kaggle, github, filesystem   â”‚
â”‚ crawler               â”‚ Crawler Agent                  â”‚ Web crawling and research ag... â”‚ tavily, github               â”‚
â”‚ github-agent          â”‚ GitHub Agent                   â”‚ Manages GitHub repositories,... â”‚ github, gmail                â”‚
â”‚ financial-viz         â”‚ Financial Visualization Agent  â”‚ Analyzes financial market da... â”‚ alphavantage, chart          â”‚
â”‚ information-routing   â”‚ Information Routing Agent      â”‚ Routes information between G... â”‚ gdrive, slack                â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
Total: 5 agent spec(s)
```

- **ID column**: Green text for easy identification
- **Name column**: Bold white text
- **Description column**: Dim text, truncated with ellipsis if too long
- **MCP Servers column**: Yellow text showing comma-separated server IDs

**JSON format:**
```json
[
  {
    "id": "data-acquisition",
    "name": "Data Acquisition Agent",
    "description": "Acquires and manages data from various sources including Kaggle datasets and GitHub repositories.",
    "mcp_servers": ["kaggle", "github", "filesystem"]
  },
  {
    "id": "crawler",
    "name": "Crawler Agent",
    "description": "Web crawling and research agent that searches the web and analyzes content.",
    "mcp_servers": ["tavily", "github"]
  }
]
```

### Programmatic Usage

```python
from agent_runtimes.commands import get_agent_specs, list_agent_specs

# Get specs as list of dictionaries (no output printed)
specs = get_agent_specs()
for spec in specs:
    print(f"{spec['id']}: {spec['name']}")
    print(f"  MCP Servers: {', '.join(spec['mcp_servers'])}")

# Or print formatted output
from agent_runtimes.commands import OutputFormat
list_agent_specs(output=OutputFormat.table)
```

---

## Environment Variables

All CLI options can be configured via environment variables. These variables serve as defaults - CLI arguments will override them when provided.

### Configuration via Environment Variables

```bash
# Configure host and port via environment variables
export AGENT_RUNTIMES_HOST=0.0.0.0
export AGENT_RUNTIMES_PORT=8080
agent-runtimes serve  # Uses 0.0.0.0:8080

# CLI arguments override env vars
agent-runtimes serve --port 9000  # Uses 0.0.0.0:9000

# Configure agent via environment variable
export AGENT_RUNTIMES_DEFAULT_AGENT=crawler
agent-runtimes serve  # Starts with crawler agent

# Configure multiple settings at once
export AGENT_RUNTIMES_HOST=0.0.0.0
export AGENT_RUNTIMES_PORT=8080
export AGENT_RUNTIMES_WORKERS=4
export AGENT_RUNTIMES_LOG_LEVEL=warning
agent-runtimes serve  # Production-ready configuration
```

### Environment Variable Reference

| Variable | CLI Option | Description |
|----------|------------|-------------|
| `AGENT_RUNTIMES_HOST` | `--host` | Host to bind to / query |
| `AGENT_RUNTIMES_PORT` | `--port` | Port to bind to / query |
| `AGENT_RUNTIMES_RELOAD` | `--reload` | Enable auto-reload (`true`/`false`) |
| `AGENT_RUNTIMES_DEBUG` | `--debug` | Enable debug mode (`true`/`false`) |
| `AGENT_RUNTIMES_WORKERS` | `--workers` | Number of worker processes |
| `AGENT_RUNTIMES_LOG_LEVEL` | `--log-level` | Log level |
| `AGENT_RUNTIMES_DEFAULT_AGENT` | `--agent-id` | Agent spec ID to start |
| `AGENT_RUNTIMES_AGENT_NAME` | `--agent-name` | Custom name for the agent |
| `AGENT_RUNTIMES_NO_CONFIG_MCP_SERVERS` | `--no-config-mcp-servers` | Skip config MCP servers (`true`/`false`) |
| `AGENT_RUNTIMES_MCP_SERVERS` | `--mcp-servers` | Comma-separated list of MCP server IDs |
| `AGENT_RUNTIMES_CODEMODE` | `--codemode` | Enable Code Mode (`true`/`false`) |
| `AGENT_RUNTIMES_SKILLS` | `--skills` | Comma-separated list of skills |

:::tip Docker and Kubernetes
Environment variables are particularly useful for containerized deployments where you want to configure the server without modifying the command:

```dockerfile
ENV AGENT_RUNTIMES_HOST=0.0.0.0
ENV AGENT_RUNTIMES_PORT=8000
ENV AGENT_RUNTIMES_WORKERS=4
CMD ["agent-runtimes", "serve"]
```

```yaml
# Kubernetes ConfigMap
apiVersion: v1
kind: ConfigMap
metadata:
  name: agent-runtimes-config
data:
  AGENT_RUNTIMES_HOST: "0.0.0.0"
  AGENT_RUNTIMES_PORT: "8000"
  AGENT_RUNTIMES_DEFAULT_AGENT: "crawler"
```
:::

---

## API Documentation

Once the server is running, interactive API documentation is available at:

- **Swagger UI:** `http://localhost:8000/docs`
- **ReDoc:** `http://localhost:8000/redoc`
